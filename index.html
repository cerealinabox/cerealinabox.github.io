<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Combined Assignment Table</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    /* Global reset / base */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f3f4f6;
      padding: 1.5rem;
    }

    h1 {
      margin-bottom: 1rem;
      text-align: center;
    }

    table.layouts {
      width: 100%;
      border-collapse: collapse;
    }

    table.layouts tr + tr {
      border-top: 1px solid #d1d5db;
    }

    table.layouts td {
      padding: 1rem 0;
      vertical-align: top;
    }

    .layout-label {
      font-weight: 600;
      margin-bottom: 0.5rem;
    }

    .layout {
      border-radius: 0.75rem;
      overflow: hidden;
      border: 1px solid #e5e7eb;
      background: #ffffff;
      max-width: 900px;
      margin: 0 auto;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.04);
    }

    .layout header,
    .layout footer,
    .layout nav,
    .layout main,
    .layout aside {
      padding: 0.75rem 1rem;
      font-size: 0.9rem;
    }

    .layout header {
      font-weight: 600;
      color: #ffffff;
    }

    .layout footer {
      font-size: 0.75rem;
      text-align: center;
    }

    /* -------------------------
       LAYOUT 1: PSI Dashboard
       ------------------------- */
    .layout-1 header {
      background: #1f2937;
    }

    .layout-1 nav {
      background: #111827;
      color: #e5e7eb;
    }

    .layout-1 nav a {
      margin-right: 0.75rem;
      color: inherit;
      text-decoration: none;
      font-size: 0.85rem;
    }

    .layout-1 nav a:hover {
      text-decoration: underline;
    }

    .layout-1 main {
      padding-top: 1rem;
      padding-bottom: 1rem;
    }

    .layout-1 main h2 {
      margin-bottom: 8px;
    }

    #last-updated {
      color: #555;
      margin-bottom: 20px;
    }

    .layout-1 main button {
      margin-bottom: 20px;
      padding: 8px 16px;
      font-size: 14px;
      cursor: pointer;
    }

    .error {
      color: #c00;
      font-weight: bold;
      margin-top: 10px;
    }

    #PSItable {
      border: 2px solid #444;
      border-collapse: collapse;
      margin-top: 40px;
      width: 100%;
      table-layout: fixed;
    }

    #PSItable th,
    #PSItable td {
      border: 2px solid #444;
      padding: 8px;
      font-weight: bold;
      text-align: center;
      overflow-wrap: break-word;
      word-break: break-all;
    }

    #PSItable th {
      background-color: #ffb561;
    }

    #PSItable td:first-child,
    #PSItable th:first-child {
      text-align: left;
    }

    /* -------------------------
       LAYOUT 2: IDV Assignment
       Header + Left Sidebar
       ------------------------- */
    .layout-2 header {
      background: #047857;
    }

    .layout-2 .body {
      display: grid;
      grid-template-columns: 180px 1fr;
    }

    .layout-2 aside {
      background: #ecfdf5;
      border-right: 1px solid #d1fae5;
    }

    .layout-2 aside strong {
      display: block;
      margin-bottom: 0.4rem;
    }

    .layout-2 aside p {
      font-size: 0.8rem;
      line-height: 1.4;
    }

    .layout-2 main {
      padding-top: 1rem;
      padding-bottom: 1rem;
      overflow-x: auto;
    }

    .layout-2 footer {
      background: #f9fafb;
    }

    .layout-2 .table-responsive {
      width: 100%;
      overflow-x: auto;
    }

    .layout-2 table.idv-table {
      width: 100%;
      border-collapse: collapse;
      min-width: 480px;
      background: #ffffff;
    }

    .layout-2 table.idv-table th,
    .layout-2 table.idv-table td {
      border: 1px solid #bfbfbf;
      vertical-align: middle;
      text-align: center;
      background: #ffffff;
      padding: 8px;
    }

    .layout-2 .table-title-row th {
      height: 50px;
      background-color: #e6dccf;
      font-weight: bold;
      font-size: 1.25em;
      border: 2px solid #bfbfbf;
    }

    .layout-2 .cell {
      width: 200px;
      height: 200px;
    }

    .layout-2 .img {
      max-width: 90%;
      max-height: 90%;
      display: inline-block;
      transform-origin: center center;
      background: #ffffff;
    }

    .layout-2 .mirror {
      transform: scaleX(-1);
    }

    .layout-2 .rotate180 {
      transform: rotate(180deg);
    }

    .layout-2 .squeezeY {
      transform: scaleY(0.5);
    }

    .layout-2 .grayscale {
      filter: grayscale(100%);
    }

    .layout-2 table.idv-table td:hover {
      outline: 2px solid #e6dccf;
      outline-offset: -2px;
    }

    /* -------------------------
       LAYOUT 3: Interactive SVG Diagrams
       ------------------------- */

    :root {
      --svg-size: 220px;
      --col2-width: 260px;
      --card-bg: #fff;
      --soft-shadow: 0 8px 20px rgba(12, 24, 40, 0.06);
    }

    .layout-3 header {
      background: #1d4ed8;
    }

    .layout-3-main {
      padding: 0 1rem 1rem 1rem;
    }

    .layout-3-intro {
      text-align: left;
      margin-bottom: 0.75rem;
    }

    .layout-3-intro-title {
      font-size: 1rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
      color: #072034;
    }

    .layout-3-intro-text {
      margin: 0;
      color: #3c5866;
      font-size: 0.8rem;
    }

    .layout-3-grid {
      display: grid;
      grid-template-columns: 1fr var(--col2-width);
      gap: 12px;
      align-items: start;
    }

    .layout-3-card {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 8px;
      box-shadow: var(--soft-shadow);
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: var(--svg-size);
      overflow: visible;
    }

    .layout-3-caption {
      background: var(--card-bg);
      border-radius: 10px;
      padding: 10px;
      box-shadow: var(--soft-shadow);
      display: flex;
      flex-direction: column;
      justify-content: center;
      min-height: var(--svg-size);
    }

    .layout-3-caption-title {
      font-weight: 700;
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    .layout-3-caption-sub {
      color: #3c5866;
      font-size: 0.8rem;
      white-space: pre-line;
    }

    svg.diagram {
      width: var(--svg-size);
      height: var(--svg-size);
      display: block;
      overflow: visible;
    }

    .axis { stroke: #bbb; stroke-width: 1; }
    .grid-line { stroke: #eee; stroke-width: 0.6; }

    /* Row 1 parallelogram */
    .r1-shape { fill: rgba(60, 140, 200, 0.18); stroke: #157; stroke-width: 1.4; }
    .r1-outline { stroke: #d33; stroke-width: 2.2; fill: none; stroke-dasharray: 240; stroke-dashoffset: 240; pointer-events: none; }
    .r1-dot { fill: #023; }
    .r1-label { font-size: 9px; font-weight: 700; font-family: Arial, sans-serif; fill: #012; }
    .label-bg { fill: #fff; opacity: 0.98; rx: 3; ry: 3; }

    #parSVG:hover .r1-outline { animation: r1dash 1.6s linear infinite; }
    @keyframes r1dash { to { stroke-dashoffset: 0; } }

    /* Row 2 nodes */
    .node { fill: #e8f3fb; stroke: #0a58a3; stroke-width: 2; cursor: pointer; transition: transform 0.12s ease, fill 0.12s; }
    .node-label { font-size: 12px; fill: #05345a; font-weight: 700; text-anchor: middle; dominant-baseline: middle; pointer-events: none; }
    .conn { stroke: #ff6b00; stroke-width: 3.5; fill: none; stroke-linecap: round; stroke-linejoin: round; stroke-dasharray: 300; stroke-dashoffset: 300; transition: stroke-dashoffset 520ms linear, opacity 220ms; opacity: 0; pointer-events: none; }
    .conn.show { stroke-dashoffset: 0; opacity: 1; }

    /* Diagram 2: active node style */
    .layout-3 .node {
      fill: #e8f3fb;
      stroke: #0a58a3;
      stroke-width: 2;
      cursor: pointer;
      transition: transform 0.12s ease, fill 0.12s;
      transform-origin: center center;
      transform-box: fill-box;
    }

    .layout-3 .active .node {
      fill: #ffefdc;
      transform: scale(1.06);
    }

    /* Row 3 bimodal */
    .curve { fill: none; stroke: #0a58a3; stroke-width: 2.4; }
    .pt { fill: #012; stroke: #fff; stroke-width: 0.8; }
    .vec { stroke: #d33; stroke-width: 2.2; stroke-linecap: round; stroke-dasharray: 60; stroke-dashoffset: 60; transition: stroke-dashoffset 0.9s ease, opacity 0.3s; opacity: 0; }
    svg.bimodal:hover .vec { stroke-dashoffset: 0; opacity: 1; }

    /* Row 4 area chart */
    .chart-grid { stroke: #f0ecef; stroke-width: 1; }
    .area-fill { fill: #e78fb3; opacity: 0.6; transition: opacity 0.2s; }
    .area-line { fill: none; stroke: #c13b7a; stroke-width: 2; }
    .hover-line { stroke: #333; stroke-width: 1; stroke-dasharray: 4 2; opacity: 0; transition: opacity 0.12s; }
    .dot-circle { fill: #fff; stroke: #c13b7a; stroke-width: 2; opacity: 0; transition: opacity 0.12s; }
    .tooltip-text { fill: #072034; font-size: 12px; opacity: 1; pointer-events: none; }
    .chart:hover .area-fill { opacity: 0.85; }

    /* Row 5 bars */
    .bar {
      fill: #6aa1c9;
      transform-origin: 50% 100%;
      transform-box: fill-box;
      transform: scaleY(0.06);
      transition: transform 600ms cubic-bezier(.2, .9, .2, 1), fill 220ms;
    }
    .bar[data-s="0.95"] { --s: 0.95; }
    .bar[data-s="0.7"]  { --s: 0.7; }
    .bar[data-s="0.45"] { --s: 0.45; }

    .bars svg:hover .bar { transform: scaleY(var(--s)); }

    .bars svg .bar:hover {
      fill: #2b6f95;
      transform: scaleY(calc(var(--s) * 1.08));
      transition: transform 260ms ease;
    }

    .layout-3 footer {
      background: #eff6ff;
    }

    /* -------------------------
       LAYOUT 4: placeholder
       ------------------------- */
    .layout-4 header {
      background: #be123c;
    }

    .layout-4 footer {
      background: #fee2e2;
    }

    /* -------------------------
       LAYOUT 5: Cards layout
       (if you add it later)
       ------------------------- */
    .layout-5 header {
      background: #6b21a8;
    }

    .layout-5 main {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 1.5rem 1rem;
    }

    .layout-5 .card-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 0.75rem;
      width: 100%;
      max-width: 640px;
    }

    .layout-5 .card {
      border-radius: 0.75rem;
      border: 1px solid #e5e7eb;
      padding: 0.75rem;
      background: #faf5ff;
      font-size: 0.85rem;
    }

    .layout-5 footer {
      background: #f5f3ff;
    }

    /* Responsive tweaks */
    @media (max-width: 800px) {
      .layout-2 .body {
        grid-template-columns: 1fr;
      }

      .layout-3-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <h1>Five HTML Layouts (in one table)</h1>

  <table class="layouts">
    <!-- Layout 1 -->
    <tr>
      <td>
        <div class="layout-label">1 – PSI Dashboard (Header + Top Nav)</div>
        <div class="layout layout-1">
          <header>Singapore PSI Dashboard</header>

          <main>
            <h2>Singapore PSI Dashboard</h2>

            <button onclick="updatePSITable()">Refresh</button>
            <div id="last-updated"></div>

            <table id="PSItable">
              <colgroup>
                <col style="width: 40%;" />
                <col style="width: 12%;" />
                <col style="width: 12%;" />
                <col style="width: 12%;" />
                <col style="width: 12%;" />
                <col style="width: 12%;" />
              </colgroup>
              <tr>
                <th>Data ID</th>
                <th>Central</th>
                <th>West</th>
                <th>East</th>
                <th>North</th>
                <th>South</th>
              </tr>
            </table>

            <div id="error-msg" class="error"></div>
          </main>
        </div>
      </td>
    </tr>

    <!-- Layout 2 -->
    <tr>
      <td>
        <div class="layout-label">2 – Header + Left Sidebar (IDV-assignment2)</div>
        <div class="layout layout-2">
          <header>IDV-assignment2</header>

          <main>
            <h2>IDV-assignment2</h2>

            <div class="table-responsive">
              <table class="idv-table">
                <thead>
                  <tr class="table-title-row">
                    <th colspan="5">IDV-assignment2</th>
                  </tr>
                  <tr>
                    <th>Original</th>
                    <th>Mirror</th>
                    <th>Rotate 180°</th>
                    <th>Squeeze Y</th>
                    <th>Grayscale</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="cell"><img src="svg/01.svg" class="img original" alt="original 01.svg" /></td>
                    <td class="cell"><img src="svg/01.svg" class="img mirror" alt="mirror 01.svg" /></td>
                    <td class="cell"><img src="svg/01.svg" class="img rotate180" alt="rotate180 01.svg" /></td>
                    <td class="cell"><img src="svg/01.svg" class="img squeezeY" alt="squeezeY 01.svg" /></td>
                    <td class="cell"><img src="svg/01.svg" class="img grayscale" alt="grayscale 01.svg" /></td>
                  </tr>
                  <tr>
                    <td class="cell"><img src="svg/02.svg" class="img original" alt="original 02.svg" /></td>
                    <td class="cell"><img src="svg/02.svg" class="img mirror" alt="mirror 02.svg" /></td>
                    <td class="cell"><img src="svg/02.svg" class="img rotate180" alt="rotate180 02.svg" /></td>
                    <td class="cell"><img src="svg/02.svg" class="img squeezeY" alt="squeezeY 02.svg" /></td>
                    <td class="cell"><img src="svg/02.svg" class="img grayscale" alt="grayscale 02.svg" /></td>
                  </tr>
                  <tr>
                    <td class="cell"><img src="svg/03.svg" class="img original" alt="original 03.svg" /></td>
                    <td class="cell"><img src="svg/03.svg" class="img mirror" alt="mirror 03.svg" /></td>
                    <td class="cell"><img src="svg/03.svg" class="img rotate180" alt="rotate180 03.svg" /></td>
                    <td class="cell"><img src="svg/03.svg" class="img squeezeY" alt="squeezeY 03.svg" /></td>
                    <td class="cell"><img src="svg/03.svg" class="img grayscale" alt="grayscale 03.svg" /></td>
                  </tr>
                  <tr>
                    <td class="cell"><img src="svg/04.svg" class="img original" alt="original 04.svg" /></td>
                    <td class="cell"><img src="svg/04.svg" class="img mirror" alt="mirror 04.svg" /></td>
                    <td class="cell"><img src="svg/04.svg" class="img rotate180" alt="rotate180 04.svg" /></td>
                    <td class="cell"><img src="svg/04.svg" class="img squeezeY" alt="squeezeY 04.svg" /></td>
                    <td class="cell"><img src="svg/04.svg" class="img grayscale" alt="grayscale 04.svg" /></td>
                  </tr>
                  <tr>
                    <td class="cell"><img src="svg/05.svg" class="img original" alt="original 05.svg" /></td>
                    <td class="cell"><img src="svg/05.svg" class="img mirror" alt="mirror 05.svg" /></td>
                    <td class="cell"><img src="svg/05.svg" class="img rotate180" alt="rotate180 05.svg" /></td>
                    <td class="cell"><img src="svg/05.svg" class="img squeezeY" alt="squeezeY 05.svg" /></td>
                    <td class="cell"><img src="svg/05.svg" class="img grayscale" alt="grayscale 05.svg" /></td>
                  </tr>
                  <tr>
                    <td class="cell"><img src="svg/06.svg" class="img original" alt="original 06.svg" /></td>
                    <td class="cell"><img src="svg/06.svg" class="img mirror" alt="mirror 06.svg" /></td>
                    <td class="cell"><img src="svg/06.svg" class="img rotate180" alt="rotate180 06.svg" /></td>
                    <td class="cell"><img src="svg/06.svg" class="img squeezeY" alt="squeezeY 06.svg" /></td>
                    <td class="cell"><img src="svg/06.svg" class="img grayscale" alt="grayscale 06.svg" /></td>
                  </tr>
                  <tr>
                    <td class="cell"><img src="svg/07.svg" class="img original" alt="original 07.svg" /></td>
                    <td class="cell"><img src="svg/07.svg" class="img mirror" alt="mirror 07.svg" /></td>
                    <td class="cell"><img src="svg/07.svg" class="img rotate180" alt="rotate180 07.svg" /></td>
                    <td class="cell"><img src="svg/07.svg" class="img squeezeY" alt="squeezeY 07.svg" /></td>
                    <td class="cell"><img src="svg/07.svg" class="img grayscale" alt="grayscale 07.svg" /></td>
                  </tr>
                  <tr>
                    <td class="cell"><img src="svg/08.svg" class="img original" alt="original 08.svg" /></td>
                    <td class="cell"><img src="svg/08.svg" class="img mirror" alt="mirror 08.svg" /></td>
                    <td class="cell"><img src="svg/08.svg" class="img rotate180" alt="rotate180 08.svg" /></td>
                    <td class="cell"><img src="svg/08.svg" class="img squeezeY" alt="squeezeY 08.svg" /></td>
                    <td class="cell"><img src="svg/08.svg" class="img grayscale" alt="grayscale 08.svg" /></td>
                  </tr>
                  <tr>
                    <td class="cell"><img src="svg/09.svg" class="img original" alt="original 09.svg" /></td>
                    <td class="cell"><img src="svg/09.svg" class="img mirror" alt="mirror 09.svg" /></td>
                    <td class="cell"><img src="svg/09.svg" class="img rotate180" alt="rotate180 09.svg" /></td>
                    <td class="cell"><img src="svg/09.svg" class="img squeezeY" alt="squeezeY 09.svg" /></td>
                    <td class="cell"><img src="svg/09.svg" class="img grayscale" alt="grayscale 09.svg" /></td>
                  </tr>
                  <tr>
                    <td class="cell"><img src="svg/10.svg" class="img original" alt="original 10.svg" /></td>
                    <td class="cell"><img src="svg/10.svg" class="img mirror" alt="mirror 10.svg" /></td>
                    <td class="cell"><img src="svg/10.svg" class="img rotate180" alt="rotate180 10.svg" /></td>
                    <td class="cell"><img src="svg/10.svg" class="img squeezeY" alt="squeezeY 10.svg" /></td>
                    <td class="cell"><img src="svg/10.svg" class="img grayscale" alt="grayscale 10.svg" /></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </main>
        </div>
      </td>
    </tr>

    <!-- Layout 3 -->
    <tr>
      <td>
        <div class="layout-label">3 – Interactive SVG Diagrams</div>
        <div class="layout layout-3">
          <header>Interactive SVG Diagrams</header>

          <main class="layout-3-main">
            <div class="layout-3-intro">
              <div class="layout-3-intro-title">Hover each diagram to see interactions</div>
              <p class="layout-3-intro-text">
                Left column shows SVG diagrams, right column explains what each interaction does.
              </p>
            </div>

            <div class="layout-3-grid">
              <!-- ROW 1 -->
              <div class="layout-3-card" aria-label="Diagram 1: parallelogram">
                <svg id="parSVG" class="diagram" width="220" height="220" viewBox="-8 -8 116 116" role="img" aria-labelledby="cap1">
                  <title id="cap1">Parallelogram — hover to animate outline (red)</title>
                  <rect x="-8" y="-8" width="116" height="116" fill="#fff" />
                  <g aria-hidden="true">
                    <g class="grid-line">
                      <line x1="10" x2="10" y1="0" y2="100" />
                      <line x1="20" x2="20" y1="0" y2="100" />
                      <line x1="30" x2="30" y1="0" y2="100" />
                      <line x1="40" x2="40" y1="0" y2="100" />
                      <line x1="50" x2="50" y1="0" y2="100" />
                      <line x1="60" x2="60" y1="0" y2="100" />
                      <line x1="70" x2="70" y1="0" y2="100" />
                      <line x1="80" x2="80" y1="0" y2="100" />
                      <line x1="90" x2="90" y1="0" y2="100" />
                      <line y1="10" y2="10" x1="0" x2="100" />
                      <line y1="20" y2="20" x1="0" x2="100" />
                      <line y1="30" y2="30" x1="0" x2="100" />
                      <line y1="40" y2="40" x1="0" x2="100" />
                      <line y1="50" y2="50" x1="0" x2="100" />
                      <line y1="60" y2="60" x1="0" x2="100" />
                      <line y1="70" y2="70" x1="0" x2="100" />
                      <line y1="80" y2="80" x1="0" x2="100" />
                      <line y1="90" y2="90" x1="0" x2="100" />
                    </g>
                  </g>

                  <polygon class="r1-shape" points="20,20 80,20 60,80 0,80" />
                  <polyline class="r1-outline" points="20,20 80,20 60,80 0,80 20,20" />

                  <circle class="r1-dot" cx="20" cy="20" r="2.8" />
                  <circle class="r1-dot" cx="80" cy="20" r="2.8" />
                  <circle class="r1-dot" cx="60" cy="80" r="2.8" />
                  <circle class="r1-dot" cx="0"  cy="80" r="2.8" />

                  <g transform="translate(24,8)">
                    <rect class="label-bg" x="-6" y="-7" width="54" height="16" rx="3"></rect>
                    <text class="r1-label" x="0" y="4">A (2,2)</text>
                  </g>
                  <g transform="translate(84,8)">
                    <rect class="label-bg" x="-6" y="-7" width="54" height="16" rx="3"></rect>
                    <text class="r1-label" x="0" y="4">B (8,2)</text>
                  </g>
                  <g transform="translate(64,88)">
                    <rect class="label-bg" x="-6" y="-7" width="54" height="16" rx="3"></rect>
                    <text class="r1-label" x="0" y="4">C (6,8)</text>
                  </g>
                  <g transform="translate(8,88)">
                    <rect class="label-bg" x="-6" y="-7" width="44" height="16" rx="3"></rect>
                    <text class="r1-label" x="0" y="4">D (0,8)</text>
                  </g>
                </svg>
              </div>

              <div class="layout-3-caption">
                <div class="layout-3-caption-title">Diagram 1</div>
                <div class="layout-3-caption-sub">
                  [Interaction] Hover to highlight the outline of the parallelogram.
                </div>
              </div>

              <!-- ROW 2 -->
              <div class="layout-3-card" aria-label="Diagram 2 nodes">
                <svg id="nodesSVG" class="diagram" viewBox="0 0 400 220" preserveAspectRatio="xMidYMid meet" role="img" aria-labelledby="cap2">
                  <title id="cap2">Alphabet nodes — hover on a node to connect it to A</title>
                  <rect width="400" height="220" fill="#fff" opacity="0" />
                  <path id="conn" class="conn" d="" />

                  <g id="node-A" transform="translate(80,110)" data-id="A" aria-hidden="true">
                    <circle class="node" r="20"></circle>
                    <text class="node-label">A</text>
                  </g>

                  <g id="node-B" transform="translate(220,30)" data-id="B" tabindex="0" role="button" aria-label="B">
                    <circle class="node" r="18"></circle>
                    <text class="node-label">B</text>
                  </g>

                  <g id="node-C" transform="translate(350,60)" data-id="C" tabindex="0" role="button" aria-label="C">
                    <circle class="node" r="18"></circle>
                    <text class="node-label">C</text>
                  </g>

                  <g id="node-D" transform="translate(300,160)" data-id="D" tabindex="0" role="button" aria-label="D">
                    <circle class="node" r="18"></circle>
                    <text class="node-label">D</text>
                  </g>

                  <g id="node-E" transform="translate(180,175)" data-id="E" tabindex="0" role="button" aria-label="E">
                    <circle class="node" r="18"></circle>
                    <text class="node-label">E</text>
                  </g>

                  <g id="node-F" transform="translate(40,40)" data-id="F" tabindex="0" role="button" aria-label="F">
                    <circle class="node" r="18"></circle>
                    <text class="node-label">F</text>
                  </g>

                  <g id="node-G" transform="translate(320,100)" data-id="G" tabindex="0" role="button" aria-label="G">
                    <circle class="node" r="18"></circle>
                    <text class="node-label">G</text>
                  </g>
                </svg>
              </div>

              <div class="layout-3-caption">
                <div class="layout-3-caption-title">Diagram 2</div>
                <div class="layout-3-caption-sub">
                  [Interaction] Hover on any letter node to draw an animated path from A to that node.
                </div>
              </div>

              <!-- ROW 3 -->
              <div class="layout-3-card" aria-label="Diagram 3 bimodal">
                <svg id="bimodalSVG" class="diagram bimodal" viewBox="-5 -5 110 110" role="img" aria-labelledby="cap3">
                  <title id="cap3">Bimodal curve — hover to show sample points and tangent vectors</title>
                  <rect width="100" height="100" fill="#fff" />
                  <g class="grid-line" aria-hidden="true">
                    <line x1="10" x2="10" y1="0" y2="100" />
                    <line x1="20" x2="20" y1="0" y2="100" />
                    <line x1="30" x2="30" y1="0" y2="100" />
                    <line x1="40" x2="40" y1="0" y2="100" />
                    <line x1="50" x2="50" y1="0" y2="100" />
                    <line x1="60" x2="60" y1="0" y2="100" />
                    <line x1="70" x2="70" y1="0" y2="100" />
                    <line x1="80" x2="80" y1="0" y2="100" />
                    <line x1="90" x2="90" y1="0" y2="100" />
                    <line y1="10" y2="10" x1="0" x2="100" />
                    <line y1="20" y2="20" x1="0" x2="100" />
                    <line y1="30" y2="30" x1="0" x2="100" />
                    <line y1="40" y2="40" x1="0" x2="100" />
                    <line y1="50" y2="50" x1="0" x2="100" />
                    <line y1="60" y2="60" x1="0" x2="100" />
                    <line y1="70" y2="70" x1="0" x2="100" />
                    <line y1="80" y2="80" x1="0" x2="100" />
                    <line y1="90" y2="90" x1="0" x2="100" />
                  </g>

                  <path id="curvePath" class="curve" d="M5,70 C25,10 35,5 50,30 C65,55 75,10 95,70" />

                  <g id="samplePoints"></g>
                  <g id="tangentLines"></g>
                </svg>
              </div>

              <div class="layout-3-caption">
                <div class="layout-3-caption-title">Diagram 3</div>
                <div class="layout-3-caption-sub">
                  [Interaction] Hover to reveal sampled points on the curve and animated tangent lines.
                </div>
              </div>

              <!-- ROW 4 -->
              <div class="layout-3-card" aria-label="Diagram 4 frequency chart">
                <svg id="chart" class="diagram chart" viewBox="0 0 200 120" role="img" aria-labelledby="cap4">
                  <title id="cap4">Frequency area chart — hover to show tooltip and frequency</title>
                  <rect width="200" height="120" fill="#fff" />

                  <g class="chart-grid" aria-hidden="true">
                    <line x1="50" x2="50" y1="10" y2="100" />
                    <line x1="80" x2="80" y1="10" y2="100" />
                    <line x1="110" x2="110" y1="10" y2="100" />
                    <line x1="140" x2="140" y1="10" y2="100" />
                    <line x1="170" x2="170" y1="10" y2="100" />
                    <line x1="30" x2="190" y1="20" y2="20" />
                    <line x1="30" x2="190" y1="40" y2="40" />
                    <line x1="30" x2="190" y1="60" y2="60" />
                    <line x1="30" x2="190" y1="80" y2="80" />
                    <line x1="30" x2="190" y1="100" y2="100" />
                  </g>

                  <g aria-hidden="true">
                    <line class="axis" x1="30" x2="30" y1="10" y2="100" />
                    <line class="axis" x1="30" x2="190" y1="100" y2="100" />
                  </g>

                  <path id="area" class="area-fill"></path>
                  <path id="line" class="area-line"></path>

                  <line id="vline" class="hover-line" x1="0" x2="0" y1="10" y2="100"></line>
                  <circle id="dot" class="dot-circle" r="4"></circle>
                  <g id="tooltip" style="display:none">
                    <rect x="0" y="0" width="70" height="22" rx="4" ry="4" fill="#fff" stroke="#ddd" />
                    <text id="tooltip-text" class="tooltip-text" x="8" y="15">val</text>
                  </g>
                </svg>
              </div>

              <div class="layout-3-caption">
                <div class="layout-3-caption-title">Diagram 4</div>
                <div class="layout-3-caption-sub">
                  [Interaction] Move your mouse along the chart to see a tooltip with the frequency value.
                </div>
              </div>

              <!-- ROW 5 -->
              <div class="layout-3-card bars" aria-label="Diagram 5 bar chart">
                <svg class="diagram" viewBox="0 0 120 100" role="img" aria-labelledby="cap5">
                  <title id="cap5">Bar chart — hover to grow bars from axis</title>
                  <rect width="120" height="100" fill="#fff" opacity="0" />
                  <line x1="10" x2="10" y1="10" y2="90" stroke="#bbb" stroke-width="1" />
                  <line x1="10" x2="110" y1="90" y2="90" stroke="#bbb" stroke-width="1" />

                  <g transform="translate(22,0)">
                    <rect class="bar" x="0" y="30" width="18" height="60" data-s="0.95"></rect>
                  </g>
                  <g transform="translate(52,0)">
                    <rect class="bar" x="0" y="42" width="18" height="48" data-s="0.7"></rect>
                  </g>
                  <g transform="translate(82,0)">
                    <rect class="bar" x="0" y="58" width="18" height="32" data-s="0.45"></rect>
                  </g>

                  <text x="31" y="96" font-size="9" text-anchor="middle">A</text>
                  <text x="61" y="96" font-size="9" text-anchor="middle">B</text>
                  <text x="91" y="96" font-size="9" text-anchor="middle">C</text>
                </svg>
              </div>

              <div class="layout-3-caption">
                <div class="layout-3-caption-title">Diagram 5</div>
                <div class="layout-3-caption-sub">
                  [Interaction] Hover over the chart to animate the bars growing from the axis.
                </div>
              </div>
            </div>
          </main>
        </div>
      </td>
    </tr>

    <!-- Layout 4 (placeholder for now) -->
    <tr>
      <td>
        <div class="layout-label">4 – Placeholder Layout</div>
        <div class="layout layout-4">
          <header>Layout 4</header>
          <footer>© 2025 Layout 4</footer>
        </div>
      </td>
    </tr>
  </table>

  <!-- PSI dashboard script -->
  <script src="psi_dashboard.js"></script>

  <!-- SVG diagram interactions -->
  <script>
    const $  = (s, r=document) => r.querySelector(s);
    const $$ = (s, r=document) => Array.from((r || document).querySelectorAll(s));

    /* ROW 2: nodes A..G interactions (refactored) */
    (() => {
      const svg = document.getElementById('nodesSVG');
      if (!svg) return;

      const conn = svg.querySelector('#conn');
      const nodeA = svg.querySelector('#node-A');
      if (!conn || !nodeA) return;

      const getCenter = (g) => {
        const t = g.getAttribute('transform') || '';
        const m = /translate\(\s*([-\d.]+)[ ,]+([-\d.]+)\s*\)/.exec(t);
        if (m) return { x: +m[1], y: +m[2] };

        const circle = g.querySelector('circle');
        const box = circle.getBBox();
        return {
          x: box.x + box.width / 2,
          y: box.y + box.height / 2
        };
      };

      const aCenter = getCenter(nodeA);
      const nodeIds = ['node-B', 'node-C', 'node-D', 'node-E', 'node-F', 'node-G'];

      const setupNodeHover = (nodeId) => {
        const g = document.getElementById(nodeId);
        if (!g) return;

        const onEnter = () => {
          const c = getCenter(g);
          const mx = (aCenter.x + c.x) / 2;
          const cpY = Math.min(aCenter.y, c.y) - 20;
          const d = `M ${aCenter.x} ${aCenter.y} Q ${mx} ${cpY} ${c.x} ${c.y}`;
          conn.setAttribute('d', d);
          conn.classList.add('show');
          g.classList.add('active');
        };

        const onLeave = () => {
          conn.classList.remove('show');
          g.classList.remove('active');
        };

        g.addEventListener('mouseenter', onEnter);
        g.addEventListener('mouseleave', onLeave);
        g.addEventListener('focus', onEnter);
        g.addEventListener('blur', onLeave);
      };

      nodeIds.forEach(setupNodeHover);
    })();

    /* ROW 3: sample points and tangent lines */
    (() => {
      const svg = $('#bimodalSVG');
      if (!svg) return;
      const path = $('#curvePath', svg);
      if (!path) return;

      const ptsG = $('#samplePoints', svg);
      const vecG = $('#tangentLines', svg);

      const total = path.getTotalLength();
      const samples = 6;
      const arrowLen = 18;
      const delta = Math.max(1, total * 0.006);

      for (let i = 0; i < samples; i++) {
        const L = ((i + 1) / (samples + 1)) * total;
        const p = path.getPointAtLength(L);

        const c = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
        c.setAttribute('class', 'pt');
        c.setAttribute('r', '2.8');
        c.setAttribute('cx', `${p.x}`);
        c.setAttribute('cy', `${p.y}`);
        ptsG.appendChild(c);

        const f = path.getPointAtLength(Math.min(total, L + delta));
        let dx = f.x - p.x;
        let dy = f.y - p.y;
        const len = Math.hypot(dx, dy) || 1;
        dx /= len;
        dy /= len;

        const x2 = p.x + dx * arrowLen;
        const y2 = p.y + dy * arrowLen;

        const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
        line.setAttribute('class', 'vec');
        line.setAttribute('x1', `${p.x}`);
        line.setAttribute('y1', `${p.y}`);
        line.setAttribute('x2', `${x2}`);
        line.setAttribute('y2', `${y2}`);
        vecG.appendChild(line);
      }
    })();

    /* ROW 4: area chart with hover tooltip */
    (() => {
      const svg = $('#chart');
      if (!svg) return;

      const area = $('#area', svg);
      const line = $('#line', svg);
      const vline = $('#vline', svg);
      const dot = $('#dot', svg);
      const tip = $('#tooltip', svg);
      const ttext = $('#tooltip-text', svg);

      const data = [
        { x: 0,    v: 0   },
        { x: 0.08, v: 0.5 },
        { x: 0.18, v: 1.2 },
        { x: 0.28, v: 0.6 },
        { x: 0.38, v: 0.9 },
        { x: 0.48, v: 2.5 },
        { x: 0.58, v: 1.1 },
        { x: 0.68, v: 3.5 },
        { x: 0.78, v: 2.2 },
        { x: 0.88, v: 4.0 },
        { x: 1,    v: 0.8 }
      ];

      const left = 30, right = 190, bottom = 100, top = 10;
      const w = right - left;
      const h = bottom - top;
      const vmax = Math.max(...data.map(d => d.v));

      const vx = t => left + t * w;
      const vy = v => bottom - (v / vmax) * h;

      let dArea = `M ${vx(data[0].x)} ${bottom}`;
      let dLine = `M ${vx(data[0].x)} ${vy(data[0].v)}`;

      data.forEach((pt, i) => {
        const x = vx(pt.x);
        const y = vy(pt.v);
        dArea += ` L ${x} ${y}`;
        if (i > 0) dLine += ` L ${x} ${y}`;
      });

      dArea += ` L ${vx(data[data.length - 1].x)} ${bottom} Z`;

      area.setAttribute('d', dArea);
      line.setAttribute('d', dLine);

      vline.style.opacity = 0;
      dot.style.opacity  = 0;
      tip.style.display  = 'none';

      svg.addEventListener('mousemove', (e) => {
        const pt = svg.createSVGPoint();
        pt.x = e.clientX;
        pt.y = e.clientY;
        const p = pt.matrixTransform(svg.getScreenCTM().inverse());

        if (p.x < left || p.x > right) {
          vline.style.opacity = 0;
          dot.style.opacity   = 0;
          tip.style.display   = 'none';
          return;
        }

        vline.setAttribute('x1', p.x);
        vline.setAttribute('x2', p.x);
        vline.style.opacity = 1;

        const tx = (p.x - left) / w;
        let best = Infinity;
        let nearest = data[0];

        data.forEach(d => {
          const dd = Math.abs(d.x - tx);
          if (dd < best) {
            best = dd;
            nearest = d;
          }
        });

        const nx = vx(nearest.x);
        const ny = vy(nearest.v);

        dot.setAttribute('cx', nx);
        dot.setAttribute('cy', ny);
        dot.style.opacity = 1;

        tip.style.display = 'block';
        const txPos = Math.min(120, Math.max(10, nx + 6));
        tip.setAttribute('transform', `translate(${txPos},${Math.max(12, ny - 28)})`);
        if (ttext) ttext.textContent = `freq: ${nearest.v.toFixed(2)}`;
      });

      svg.addEventListener('mouseleave', () => {
        vline.style.opacity = 0;
        dot.style.opacity   = 0;
        tip.style.display   = 'none';
      });
    })();

    /* Row 5 bars: CSS-only animation (no JS needed) */
  </script>
</body>
</html>
